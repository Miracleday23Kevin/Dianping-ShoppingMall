#!/usr/bin/env python# _*_ coding: utf-8 _*___author__ = 'miracleday23'import jsonimport osimport timeimport pandas as pdpath = '/Users/miracleday23/Desktop/DataAnalysisTools/ShoppingMall/dianpingdata/Shoppingmall_Compliment/json'def Key_Stats(gather = "Shopping_mall_attributes_mobile"):    list_dir = [x[0] for x in os.walk(path)]    # print list_dir[:4]    package_list = list_dir[1:]    print package_list    # print package_list[0]    '''    From every direction, get all the details information out.    '''    '''    In this part, you have to switch to different directions manually.    '''    df = pd.DataFrame(columns= ['total_shop',                                'clothes_and_shoes',                                'food',                                'entertainment',                                'makeup',                                'shopping',                                'digital',                                'other',                                'group_purchase',                                'comment',                                'checkins',                                'shopid',                                'MetroStation'])    each_file = os.listdir(package_list[2])    # print each_file    file = open("MetrostationShanghai.txt", 'r')    content = file.read()    # print content    table = content.split()    print table    # break    if len(each_file)>0:        for file in each_file:            shop_id = file.split('.')[0]            # print shop_id            full_file_path = package_list[2] + '/' + file            source = open(full_file_path,'r')            plain_text = source.read()            # print plain_text            # break            # plain_text = plain_text            try:                json_file = json.loads(plain_text)            except Exception as e:                print e            clothes_and_shoes = json_file["cloth_and_shoes"]            total_shop = json_file["total_shop"]            food = json_file["food"]            entertainment = json_file["entertainment"]            makeup = json_file["makeup"]            shopping = json_file["shopping"]            digital = json_file["digital"]            other = json_file["other"]            group_purchase = json_file["group_purchase"]            comment = json_file["comment"]            checkins = json_file["review_short"]            shopid = shop_id            print shop_id            try:                if shopid in table[:]:                    MetroStation = 1                else:                    MetroStation = 0            except Exception as e:                print e            try:                df = df.append({'total_shop':total_shop,                                'clothes_and_shoes':clothes_and_shoes,                                'food':food,                                'entertainment':entertainment,                                'makeup':makeup,                                'shopping':shopping,                                'digital':digital,                                'other':other,                                'group_purchase':group_purchase,                                'comment':comment,                                'checkins':checkins,                                'shopid':shopid,                                'MetroStation':MetroStation,                                },ignore_index= True)            except Exception as e:                print e    # file.close()    save = gather.replace(' ','').replace(')','').replace('(','').replace('/','')+('.csv')    print save    df.to_csv(save,encoding='utf-8')Key_Stats()        # print latitude