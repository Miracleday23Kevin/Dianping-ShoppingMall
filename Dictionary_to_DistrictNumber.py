# _*_ coding: utf-8 _*___author__ = 'miracleday23'import jsonimport osimport timeimport pandas as pdpath = '/Users/miracleday23/Desktop/DataAnalysisTools/ShoppingMall/dianpingdata/Shoppingmall_Compliment/json'District1_dictionary_Beijing = {u'海淀区':1,                                u'东城区':2,                                u'西城区':3,                                u'朝阳区':4,                                u'丰台区':5,                                u'石景山区':6,                                u'大兴区':7,                                u'顺义区':8,                                u'通州区':9,                                u'昌平区':10,                                u'怀柔区':11,                                u'门头沟区':12,                                u'延庆县其他':13,                                u'密云镇':14,                                u'房山区':15,                                u'平谷区':16,                                u'密云县其他':17,                                u'密云沙河':18,                                u'密云鼓楼':19,                                u'石城镇':20}District1_dictionary_Shanghai = {u'嘉定区':1,                                u'宝山区':2,                                u'闸北区':3,                                u'普陀区':4,                                u'长宁区':5,                                u'浦东新区':6,                                u'徐汇区':7,                                u'青浦区':8,                                u'虹口区':9,                                u'卢湾区':10,                                u'静安区':11,                                u'闵行区':12,                                u'奉贤区':13,                                u'金山区':14,                                u'黄浦区':15,                                u'杨浦区':16,                                u'松江区':17,                                u'崇明县其他':18,                                u'陈家镇':19,                                u'新河镇':20,                                u'长兴镇':21,                                 u'其他':22}District2_dictionary_Beijing = {u'西单':1,                                u'建外大街':2,                                u'王府井/东单':3,                                u'亮马桥/三元桥':4,                                u'亚运村':5,                                u'朝外大街':6,                                u'国贸':7,                                u'十里堡':8,                                u'中关村':9,                                u'望京':10,                                u'大望路':11,                                u'酒仙桥':12,                                u'五道口':13,                                u'三里屯':14,                                u'朝阳公园/团结湖':15,                                u'双井':16,                                u'其他':17,}District2_dictionary_Shanghai = {u'徐家汇':1,                                u'金桥':2,                                u'静安寺':3,                                u'八佰伴':4,                                u'莘庄':5,                                u'中山公园':6,                                u'五角场/大学区':7,                                u'上南地区':8,                                u'张江':9,                                u'世纪公园':10,                                u'人民广场':11,                                u'淮海路':12,                                u'虹桥镇':13,                                u'陆家嘴':14,                                u'虹桥':15,                                u'南京西路':16,                                u'其他':17,}def get_District_Beijing(gather = "Shanghai_shopping_mall_district"):    df = pd.DataFrame(columns= ['Shopid',                                'District',                                'Area'])    list_dir = [x[0] for x in os.walk(path)]    # print list_dir[:4]    package_list = list_dir[1:]    # print package_list    print package_list[3]    each_file = os.listdir(package_list[3])    print each_file    # break    if len(each_file)>0:        for file in each_file:            shop_id = file.split('.')[0]            # print shop_id            full_file_path = package_list[3] + '/' + file            source = open(full_file_path,'r')            plain_text = source.read()            # print plain_text            # break            json_file = json.loads(plain_text)            Shopid = shop_id            # print District1_dictionary_Beijing[u'海淀区']            # print District1_dictionary_Beijing[json_file["district1"]]            temp = json_file["district1"].strip()            print temp            temp1 = json_file["district2"].strip()            print temp1            print District1_dictionary_Shanghai[temp]            print District2_dictionary_Shanghai[temp1]            try:                District = District1_dictionary_Shanghai[json_file["district1"].strip()]            except Exception as e:                print e            try:                Area = District2_dictionary_Shanghai[json_file["district2"]]            except Exception as e:                print e            try:                df = df.append({'Shopid':Shopid,                                'District':District,                                'Area':Area},ignore_index= True)            except Exception as e:                print e            # break            source.close()    save = gather.replace(' ','').replace(')','').replace('(','').replace('/','')+('.csv')    print save    df.to_csv(save,encoding='utf-8')get_District_Beijing()