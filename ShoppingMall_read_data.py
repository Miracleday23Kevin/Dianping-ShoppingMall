#!/usr/bin/env python# _*_ coding: utf-8 _*___author__ = 'miracleday23'import jsonimport osimport timeimport pandas as pdpath = '/Users/miracleday23/Desktop/DataAnalysisTools/ShoppingMall/dianpingdata/Shoppingmall_Compliment/json'def Key_Stats(gather = "Shopping_mall_attributes_mobile"):    list_dir = [x[0] for x in os.walk(path)]    # print list_dir[:4]    package_list = list_dir[1:]    # print package_list    # print package_list[3]    '''    From every direction, get all the details information out.    '''    '''    for each_dir in package_list:        each_file = os.listdir(each_dir)        # print each_file        # break        if len(each_file)>0:            for file in each_file:                shop_id = file.split('.')[0]                # print shop_id                full_file_path = each_dir + '/' + file                source = open(full_file_path,'r')                plain_text = source.read()                # print plain_text                # break                json_file = json.loads(plain_text)                print json_file                # Shop_Sum = json_file['入驻商户']                # print Shop_Sum        break    '''    '''    In this part, you have to switch to different directions manually.    '''    df = pd.DataFrame(columns= ['Opentime',                                'Parkinfo',                                'cost_level',                                'Product_evaluation',                                'Environment_evaluation',                                'Service_evaluation',                                'latitude',                                'longitude',                                'Shopid',                                'District',                                'Area'])    each_file = os.listdir(package_list[3])    print each_file    # break    if len(each_file)>0:        for file in each_file:            shop_id = file.split('.')[0]            # print shop_id            full_file_path = package_list[3] + '/' + file            source = open(full_file_path,'r')            plain_text = source.read()            # print plain_text            # break            json_file = json.loads(plain_text)            latitude = json_file["lat"]            longitude = json_file["lng"]            Service_evaluation = json_file["service"]            Environment_evaluation = json_file["enviornment"]            Product_evaluation = json_file["product"]            cost_level = json_file["cost_level"]            Parkinfo = json_file["park_info"]            Opentime = json_file["time"]            Shopid = shop_id            District = json_file["district1"]            Area = json_file["district2"]            try:                df = df.append({'Shopid':Shopid,                                'Opentime':Opentime,                                'Parkinfo':Parkinfo,                                'cost_level':cost_level,                                'Product_evaluation':Product_evaluation,                                'Environment_evaluation':Environment_evaluation,                                'Service_evaluation':Service_evaluation,                                'latitude':latitude,                                'longitude':longitude,                                'District':District,                                'Area':Area},ignore_index= True)            except Exception as e:                print e    save = gather.replace(' ','').replace(')','').replace('(','').replace('/','')+('.csv')    print save    df.to_csv(save,encoding='utf-8')Key_Stats()        # print latitude